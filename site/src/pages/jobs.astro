---
import BaseLayout from "../layouts/BaseLayout.astro";
const title = "beginner-friendly remote jobs";
---
<BaseLayout {title}>
  <section class="jobs-hero">
    <h1>beginner-friendly remote jobs</h1>
    <p class="lead">hand-curated remote opportunities you can actually land. updated regularly with entry-level and junior positions.</p>
  </section>

  <section class="card filters-section">
    <div class="filters-grid">
      <div class="search-group">
        <label for="q" class="filter-label">search</label>
        <input 
          id="q" 
          type="text"
          placeholder="job title, company, skills..." 
          class="filter-input search-input"
        />
      </div>

      <div class="filter-group">
        <label for="level" class="filter-label">experience level</label>
        <select id="level" class="filter-select">
          <option value="">all levels</option>
          <option value="entry">entry level</option>
          <option value="junior">junior (1-2 years)</option>
          <option value="experienced">experienced (3+ years)</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="jobType" class="filter-label">job type</label>
        <select id="jobType" class="filter-select">
          <option value="">all types</option>
          <option value="full-time">full-time</option>
          <option value="part-time">part-time</option>
          <option value="contract">contract</option>
          <option value="internship">internship</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="category" class="filter-label">category</label>
        <select id="category" class="filter-select">
          <option value="">all categories</option>
          <option value="customer-service">customer service</option>
          <option value="marketing">marketing</option>
          <option value="sales">sales</option>
          <option value="writing">writing & content</option>
          <option value="design">design</option>
          <option value="development">development</option>
          <option value="data">data & analytics</option>
          <option value="virtual-assistant">virtual assistant</option>
          <option value="project-management">project management</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="country" class="filter-label">location</label>
        <select id="country" class="filter-select">
          <option value="">all locations</option>
        </select>
      </div>

      <div class="filter-group checkbox-group">
        <label class="checkbox-label">
          <input id="globalOnly" type="checkbox" />
          <span class="checkmark"></span>
          global remote only
        </label>
      </div>
    </div>

    <div class="filter-actions">
      <button id="clearFilters" class="btn btn--outline btn-small">clear filters</button>
      <div class="results-info">
        <span id="count" class="muted">loading jobs...</span>
      </div>
    </div>
  </section>

  <section class="jobs-section">
    <ul id="list" class="jobs-list"></ul>
    
    <div id="pagination" class="pagination" style="display: none;">
      <button id="prevPage" class="btn btn--outline pagination-btn">← previous</button>
      <div id="pageInfo" class="page-info"></div>
      <button id="nextPage" class="btn btn--outline pagination-btn">next →</button>
    </div>
    
    <div id="loadingState" class="loading-state">
      <p>loading fresh remote opportunities...</p>
    </div>
    
    <div id="emptyState" class="empty-state" style="display: none;">
      <h3>no jobs match your filters</h3>
      <p>try adjusting your search criteria or <button id="clearFiltersInline" class="link-button">clear all filters</button></p>
    </div>
  </section>

  <section class="card cta-section">
    <h2>want to land remote work faster?</h2>
    <p>get our free step-by-step roadmap that shows you exactly how to transition to remote work</p>
    <a href="/course" class="btn">get the free roadmap</a>
  </section>

  <style>
    .jobs-hero {
      text-align: center;
      margin-bottom: 32px;
    }

    .jobs-hero h1 {
      margin-bottom: 12px;
    }

    .filters-section {
      margin-bottom: 24px;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1.2fr 1fr auto;
      gap: 16px;
      align-items: end;
      margin-bottom: 20px;
    }

    .search-group {
      min-width: 0;
    }

    .filter-group {
      min-width: 0;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      min-height: 44px;
    }

    .filter-label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: #555;
      margin-bottom: 6px;
    }

    .filter-input,
    .filter-select {
      width: 100%;
      padding: 10px 14px;
      border: 2px solid #e8e8e8;
      border-radius: 8px;
      font-size: 14px;
      background: #fff;
      transition: border-color 0.2s ease;
    }

    .filter-input:focus,
    .filter-select:focus {
      outline: none;
      border-color: #666;
    }

    .search-input {
      font-size: 15px;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      cursor: pointer;
      font-size: 14px;
      color: #555;
      user-select: none;
    }

    .checkbox-label input[type="checkbox"] {
      margin-right: 8px;
      width: 16px;
      height: 16px;
    }

    .filter-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 16px;
      border-top: 1px solid #f0f0f0;
    }

    .btn-small {
      padding: 8px 16px;
      font-size: 13px;
    }

    .results-info {
      font-size: 14px;
    }

    .jobs-list {
      list-style: none;
      padding: 0;
      margin: 0;
      margin-bottom: 32px;
    }

    .job-card {
      background: #fff;
      border: 2px solid #e8e8e8;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
      transition: all 0.2s ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
    }

    .job-card:hover {
      border-color: #0066cc;
      box-shadow: 0 6px 20px rgba(0, 102, 204, 0.1);
      transform: translateY(-2px);
    }

    .job-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 16px;
      margin-bottom: 16px;
    }

    .job-title {
      flex: 1;
      min-width: 0;
    }

    .job-title a {
      font-size: 18px;
      font-weight: 600;
      color: #000;
      text-decoration: none;
      line-height: 1.3;
    }

    .job-title a:hover {
      color: #0066cc;
    }

    .job-meta {
      color: #666;
      font-size: 14px;
      margin-top: 6px;
    }

    .job-actions {
      text-align: right;
      white-space: nowrap;
    }

    .job-date {
      font-size: 13px;
      color: #888;
      margin-bottom: 8px;
    }

    .apply-btn {
      padding: 10px 18px;
      font-size: 14px;
      font-weight: 500;
    }

    .job-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid #f1f3f4;
    }

    .job-tag {
      padding: 8px 14px;
      background: #f8f9fa;
      color: #495057;
      border-radius: 24px;
      font-size: 13px;
      font-weight: 500;
      border: 1px solid #e9ecef;
      text-transform: capitalize;
      white-space: nowrap;
    }

    .job-tag.level {
      background: #dbeafe;
      color: #1e40af;
      border-color: #93c5fd;
    }

    .job-tag.remote {
      background: #dcfce7;
      color: #166534;
      border-color: #86efac;
    }

    .job-tag.senior {
      background: #fed7aa;
      color: #c2410c;
      border-color: #fdba74;
    }

    .job-tag.full-time {
      background: #e9d5ff;
      color: #7c3aed;
      border-color: #c4b5fd;
    }

    .job-tag.contract {
      background: #fce7f3;
      color: #be185d;
      border-color: #f9a8d4;
    }

    .pagination {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 32px 0;
      padding: 0 8px;
    }

    .pagination-btn {
      min-width: 120px;
    }

    .pagination-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .page-info {
      font-size: 14px;
      color: #666;
      font-weight: 500;
    }

    .loading-state,
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #666;
    }

    .empty-state h3 {
      margin-bottom: 8px;
    }

    .link-button {
      background: none;
      border: none;
      color: #0066cc;
      cursor: pointer;
      text-decoration: underline;
      font-size: inherit;
    }

    .link-button:hover {
      color: #0052a3;
    }

    .cta-section {
      text-align: center;
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      margin-top: 40px;
    }

    .cta-section h2 {
      margin: 0 0 12px 0;
    }

    .cta-section p {
      margin: 0 0 24px 0;
      color: #666;
    }

    @media (max-width: 1024px) {
      .filters-grid {
        grid-template-columns: 1fr 1fr 1fr;
        gap: 12px;
      }

      .search-group {
        grid-column: 1 / -1;
      }

      .checkbox-group {
        grid-column: 1 / -1;
        justify-content: center;
      }

      .pagination {
        flex-direction: column;
        gap: 16px;
      }

      .pagination-btn {
        min-width: 160px;
      }
    }

    @media (max-width: 768px) {
      .filters-grid {
        grid-template-columns: 1fr;
        gap: 16px;
      }

      .job-header {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
      }

      .job-actions {
        text-align: left;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .filter-actions {
        flex-direction: column;
        gap: 12px;
        text-align: center;
      }

      .job-card {
        padding: 20px;
      }
    }
  </style>

  <script type="module">
    const list = document.getElementById('list');
    const count = document.getElementById('count');
    const q = document.getElementById('q');
    const level = document.getElementById('level');
    const jobType = document.getElementById('jobType');
    const category = document.getElementById('category');
    const countrySel = document.getElementById('country');
    const globalOnly = document.getElementById('globalOnly');
    const clearFilters = document.getElementById('clearFilters');
    const clearFiltersInline = document.getElementById('clearFiltersInline');
    const loadingState = document.getElementById('loadingState');
    const emptyState = document.getElementById('emptyState');
    const pagination = document.getElementById('pagination');
    const prevPage = document.getElementById('prevPage');
    const nextPage = document.getElementById('nextPage');
    const pageInfo = document.getElementById('pageInfo');

    let all = [];
    let allCountries = new Set();
    let currentPage = 1;
    const jobsPerPage = 48;

    // Country mapping
    const countryMap = new Map(Object.entries({
      "czech republic": "czechia",
      "cz": "czechia",
      "czechia": "czechia",
      "united kingdom": "uk",
      "great britain": "uk",
      "gb": "uk",
      "uk": "uk",
      "england": "uk",
      "scotland": "uk",
      "wales": "uk",
      "northern ireland": "uk",
      "united states": "usa",
      "u.s.a.": "usa",
      "u.s.": "usa",
      "us": "usa",
      "usa": "usa",
      "united arab emirates": "uae",
      "uae": "uae",
      "netherlands": "netherlands",
      "holland": "netherlands",
      "germany": "germany",
      "france": "france",
      "spain": "spain",
      "portugal": "portugal",
      "ireland": "ireland",
      "australia": "australia",
      "new zealand": "new zealand",
      "canada": "canada",
      "india": "india"
    }));

    // Global patterns
    const globalPatterns = [
      /(^|\b)remote(\b|$)/i,
      /anywhere/i,
      /worldwide/i,
      /global/i,
      /any location/i,
      /work from anywhere/i,
      /open to.*any.*timezone/i,
      /distributed/i
    ];

    function isGlobal(j) {
      const hay = [
        j.location || "",
        ...(j.tags || []),
        (j.title || "")
      ].join(" ").toLowerCase();
      return globalPatterns.some(rx => rx.test(hay));
    }

    function extractCountries(raw) {
      if (!raw) return [];
      const s = String(raw).toLowerCase();

      if (globalPatterns.some(rx => rx.test(s))) return [];

      const parts = s.split(/[\/,|•\-—]+/).map(p => p.trim()).filter(Boolean);
      const norm = parts.map(p => {
        const w = p
          .replace(/\d+/g, '')
          .replace(/\b(remote|hybrid|onsite|office|time.?zone|tz)\b/gi, '')
          .trim();
        return countryMap.get(w) || w;
      }).filter(Boolean);

      const bad = new Set(["remote", "hybrid", "onsite", "office", "", "global", "anywhere"]);
      return Array.from(new Set(norm.filter(x => !bad.has(x))));
    }

    function addCountryOptions(countries) {
      const arr = Array.from(countries).sort();
      for (const c of arr) {
        const opt = document.createElement('option');
        opt.value = c;
        opt.textContent = c;
        countrySel.appendChild(opt);
      }
    }

    function categorizeJob(job) {
      const text = (job.title + ' ' + (job.tags || []).join(' ')).toLowerCase();
      
      if (/customer.service|support|help.desk/i.test(text)) return 'customer-service';
      if (/marketing|social.media|seo|content.marketing/i.test(text)) return 'marketing';
      if (/sales|account.manager|business.development/i.test(text)) return 'sales';
      if (/writer|content|copywriter|editor|blog/i.test(text)) return 'writing';
      if (/design|ui|ux|graphic|visual/i.test(text)) return 'design';
      if (/developer|programmer|engineer|coding|software/i.test(text)) return 'development';
      if (/data|analyst|analytics|sql|excel/i.test(text)) return 'data';
      if (/virtual.assistant|va|admin|assistant/i.test(text)) return 'virtual-assistant';
      if (/project.manager|coordinator|scrum|agile/i.test(text)) return 'project-management';
      
      return 'other';
    }

    function getJobType(job) {
      const text = (job.title + ' ' + (job.tags || []).join(' ')).toLowerCase();
      
      if (/part.time|parttime/i.test(text)) return 'part-time';
      if (/contract|contractor|freelance/i.test(text)) return 'contract';
      if (/intern|internship/i.test(text)) return 'internship';
      
      return 'full-time';
    }

    function formatTag(tag) {
      const tagStr = String(tag).toLowerCase();
      let className = 'job-tag';
      
      if (/entry|junior|beginner/i.test(tagStr)) {
        className += ' level';
      } else if (/senior|experienced/i.test(tagStr)) {
        className += ' senior';
      } else if (/remote|global|anywhere/i.test(tagStr)) {
        className += ' remote';
      } else if (/full.?time/i.test(tagStr)) {
        className += ' full-time';
      } else if (/contract|freelance/i.test(tagStr)) {
        className += ' contract';
      }
      
      // Clean up the tag text - split on common separators and take meaningful parts
      const cleanTag = tag.replace(/([a-z])([A-Z])/g, '$1 $2') // camelCase to spaces
                          .replace(/[_-]/g, ' ') // underscores and dashes to spaces
                          .replace(/\s+/g, ' ') // multiple spaces to single
                          .trim();
      
      return `<span class="${className}">${cleanTag}</span>`;
    }

    async function load() {
      try {
        const res = await fetch('/jobs.json', { cache: 'no-store' });
        const data = await res.json();
        all = (data?.jobs || []).map(job => ({
          ...job,
          jobCategory: categorizeJob(job),
          jobType: getJobType(job)
        }));

        allCountries.clear();
        for (const j of all) {
          extractCountries(j.location).forEach(c => allCountries.add(c));
        }
        addCountryOptions(allCountries);

        loadingState.style.display = 'none';
        render();
      } catch (error) {
        loadingState.style.display = 'none';
        list.innerHTML = '<li class="empty-state"><p>Unable to load jobs. Please try again later.</p></li>';
      }
    }

    function render() {
      const term = q.value.trim().toLowerCase();
      const lvl = level.value;
      const jType = jobType.value;
      const cat = category.value;
      const selCountry = countrySel.value;
      const wantGlobal = globalOnly.checked;

      const filtered = all.filter(j => {
        // Text search
        const text = (j.title + ' ' + (j.company || '') + ' ' + (j.tags || []).join(' ') + ' ' + (j.location || '')).toLowerCase();
        const passTerm = !term || text.includes(term);

        // Experience level
        const isEntry = (j.tags || []).some(t => /entry|junior|beginner|entry.level/i.test(String(t)));
        const isJunior = (j.tags || []).some(t => /junior|1-2.years/i.test(String(t)));
        let passLevel = true;
        if (lvl === 'entry') passLevel = isEntry;
        else if (lvl === 'junior') passLevel = isJunior;
        else if (lvl === 'experienced') passLevel = !isEntry && !isJunior;

        // Job type
        const passJobType = !jType || j.jobType === jType;

        // Category
        const passCategory = !cat || j.jobCategory === cat;

        // Global-only
        if (wantGlobal && !isGlobal(j)) return false;

        // Single-country
        if (selCountry) {
          const cs = extractCountries(j.location);
          if (!cs.includes(selCountry)) return false;
        }

        return passTerm && passLevel && passJobType && passCategory;
      });

      // Reset to page 1 when filters change
      currentPage = 1;
      
      const totalPages = Math.ceil(filtered.length / jobsPerPage);
      const startIndex = (currentPage - 1) * jobsPerPage;
      const endIndex = startIndex + jobsPerPage;
      const currentJobs = filtered.slice(startIndex, endIndex);

      if (filtered.length === 0) {
        list.style.display = 'none';
        emptyState.style.display = 'block';
        pagination.style.display = 'none';
      } else {
        list.style.display = 'block';
        emptyState.style.display = 'none';
        
        // Show pagination only if there are multiple pages
        if (totalPages > 1) {
          pagination.style.display = 'flex';
          prevPage.disabled = currentPage === 1;
          nextPage.disabled = currentPage === totalPages;
          pageInfo.textContent = `page ${currentPage} of ${totalPages}`;
        } else {
          pagination.style.display = 'none';
        }
        
        list.innerHTML = currentJobs.map(j => {
          const tags = (j.tags || []).map(tag => formatTag(tag)).join('');

          return `
            <li class="job-card">
              <div class="job-header">
                <div class="job-title">
                  <a href="${j.source_url}" target="_blank" rel="noopener">${j.title}</a>
                  <div class="job-meta">
                    ${j.company ? j.company + ' • ' : ''}${j.location || 'remote'}
                  </div>
                </div>
                <div class="job-actions">
                  <div class="job-date">${j.posted_at ? new Date(j.posted_at).toLocaleDateString() : ''}</div>
                  <a class="btn apply-btn" href="${j.source_url}" target="_blank" rel="noopener">apply</a>
                </div>
              </div>
              ${tags ? `<div class="job-tags">${tags}</div>` : ''}
            </li>
          `;
        }).join('');
      }

      count.textContent = `${filtered.length} job${filtered.length === 1 ? '' : 's'} found`;
    }

    function clearAllFilters() {
      q.value = '';
      level.value = '';
      jobType.value = '';
      category.value = '';
      countrySel.value = '';
      globalOnly.checked = false;
      currentPage = 1;
      render();
    }

    function goToPage(page) {
      currentPage = page;
      render();
      // Scroll to top of jobs list
      list.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Event listeners
    q.addEventListener('input', render);
    level.addEventListener('change', render);
    jobType.addEventListener('change', render);
    category.addEventListener('change', render);
    countrySel.addEventListener('change', render);
    globalOnly.addEventListener('change', render);
    clearFilters.addEventListener('click', clearAllFilters);
    clearFiltersInline.addEventListener('click', clearAllFilters);
    
    prevPage.addEventListener('click', () => {
      if (currentPage > 1) goToPage(currentPage - 1);
    });
    
    nextPage.addEventListener('click', () => {
      const totalPages = Math.ceil(all.length / jobsPerPage);
      if (currentPage < totalPages) goToPage(currentPage + 1);
    });

    // Initialize
    load();
  </script>
</BaseLayout>